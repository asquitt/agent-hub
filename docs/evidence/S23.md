# Evidence

## Segment
- ID: S23
- Deliverable(s): Registry UX/API Productization
- Date: 2026-02-12

## Code Changes
- Files changed:
  - `src/api/models.py`
  - `src/api/app.py`
  - `src/ui/version_compare.html`
  - `tests/integration/test_registry_api.py`
  - `tests/operator/test_operator_ui.py`
  - `docs/operator/REGISTRY_PRODUCTIZATION_S23.md`
  - `docs/session-packets/S23.md`
- Summary:
  - Added fork API: `POST /v1/agents/{agent_id}/fork`.
  - Added version compare API with behavioral diff + eval delta:
    - `GET /v1/agents/{agent_id}/compare/{base_version}/{target_version}`.
  - Added minimal operator version-compare page:
    - `GET /operator/versioning`
    - UI file: `src/ui/version_compare.html`.
  - Added integration/operator tests validating publish/update/compare/fork and UI availability.

## Test Commands Executed
```bash
pytest tests/integration/test_registry_api.py tests/operator/test_operator_ui.py tests/capability_search/test_search_v2.py -q
```

## Test Results
- Passed:
  - `19 passed` across registry integration, operator UI, and capability-search regression suites.
- Failed: `0`
- Skipped: `0`

## Verification Evidence
- API contract validation:
  - Fork request model (`AgentForkRequest`) validated with strict schema and namespace/slug constraints.
  - Compare endpoint returns behavioral diff + eval base/target/delta payload.
- Security validation:
  - Fork endpoint uses namespace ownership checks and idempotency-key semantics.
  - Existing auth path preserved via `require_api_key`.
- Cost/latency validation:
  - Registry and capability-search regression suite remains green after S23 changes.
- Screenshots/log excerpts:
  - `pytest ... -q` output: `19 passed in 2.54s`

## Known Risks
- Version compare endpoint currently computes eval deltas from available local eval snapshots; missing eval rows default to zero deltas.
- Operator compare UI is minimal and non-auth stateful (API key entry in page), suitable for minimum productization but not final UX.

## Next Segment Handoff
- Recommended next segment: S24
- Required context for next segment:
  - S23 introduces fork/compare operator workflows; S24 should build persistent install promotion safety (approval + rollback + compatibility) on top of existing lease/promotion APIs.

## Mandatory Confirmation
- [x] `docs/agenthub-master-plan-v1.2.docx` updated
- [x] `docs/DELIVERABLE_LOG.md` updated

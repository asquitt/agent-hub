# Evidence

## Segment
- ID: S21
- Deliverable(s): Trust Graph v2
- Date: 2026-02-12

## Code Changes
- Files changed:
  - `src/trust/scoring.py`
  - `tests/trust/test_trust_scoring.py`
  - `docs/trust/TRUST_SCORING.md`
  - `docs/session-packets/S21.md`
- Summary:
  - Added recency decay weighting for usage/review/security evidence.
  - Added evidence-quality weighting to usage, community review, and security audit signals.
  - Added suspicious pattern detection:
    - `low_reviewer_diversity_detected`
    - `review_burst_detected`
    - `community_usage_mismatch_penalty_applied`
  - Introduced bounded manipulation penalty term with dedicated weight and breakdown field.
  - Added adversarial simulation tests for manipulation resistance and trust-score stability.

## Test Commands Executed
```bash
pytest tests/trust/test_trust_scoring.py tests/integration/test_registry_api.py tests/operator/test_operator_ui.py -q
```

## Test Results
- Passed:
  - `16 passed` across trust scoring and API regression suites.
- Failed: `0`
- Skipped: `0`

## Verification Evidence
- API contract validation:
  - Trust API contract remains compatible and exercised through integration tests (`tests/integration/test_registry_api.py` trust endpoint checks).
- Security validation:
  - Anti-manipulation simulation coverage:
    - `test_manipulation_penalty_detects_review_burst_without_usage`
    - `test_trust_score_stability_under_adversarial_unverified_reviews`
  - Suspicious pattern flags now emitted deterministically in trust score output.
- Cost/latency validation:
  - Trust recomputation remains deterministic under isolated fixture datasets; no latency regression observed in current local suite.
- Screenshots/log excerpts:
  - `pytest ... -q` output: `16 passed in 2.52s`

## Known Risks
- Trust graph is still file-backed and single-node for local determinism; distributed trust-event ingestion and graph persistence remain future work.
- Suspicious-pattern heuristics are intentionally conservative and may require tuning against production false positive/negative rates.

## Next Segment Handoff
- Recommended next segment: S22
- Required context for next segment:
  - S17 policy outputs + S19 delegation contracts + S20 metering + S21 trust hardening are now available as inputs for federated execution gateway policy propagation.
  - Keep trust and cost audit metadata intact across boundary adapters.

## Mandatory Confirmation
- [x] `docs/agenthub-master-plan-v1.2.docx` updated
- [x] `docs/DELIVERABLE_LOG.md` updated

# Evidence

## Segment
- ID: S46
- Deliverable(s): Federation enterprise pack
- Date: 2026-02-12

## Code Changes
- Files changed:
  - `.gitignore`
  - `src/federation/gateway.py`
  - `src/federation/__init__.py`
  - `src/api/models.py`
  - `src/api/app.py`
  - `tests/federation/test_enterprise_pack_s46.py`
  - `docs/federation/FEDERATION_ENTERPRISE_PACK_S46.md`
  - `docs/session-packets/S46.md`
- Summary:
  - Added federation enterprise domain profiles with residency region and private-connect requirements.
  - Extended federated execution contract with residency request and connection mode controls.
  - Enforced private-connect and residency boundaries in federated runtime execution.
  - Added enterprise compliance export endpoint for federation attestation/audit bundles with deterministic bundle hash.
  - Added S46 tests for federation boundary controls and admin-scoped attestation exports.

## Test Commands Executed
```bash
pytest tests/federation/test_gateway.py tests/federation/test_enterprise_pack_s46.py -q
pytest tests/integration/test_registry_api.py tests/cost_governance/test_metering_integration.py tests/operator/test_operator_ui.py -q
pytest -q
```

## Test Results
- Passed:
  - `6 passed in 0.40s` (federation gateway + S46 enterprise pack tests)
  - `16 passed in 2.61s` (integration/cost/operator bundle)
  - `156 passed in 8.53s` (full regression)
- Failed: `0`
- Skipped: `0`

## Verification Evidence
- Federation boundary controls:
  - Domains marked private-connect required deny `public_internet` connection mode.
  - Residency mismatch requests are denied deterministically.
- Compliance controls:
  - `/v1/federation/attestations/export` restricted to admin actors.
  - Export bundle includes deterministic `bundle_hash`, record counts, and residency/connectivity metadata.
- Attestation depth:
  - Federated execution attestation now carries residency and connection mode context for audit lineage.

## Known Risks
- Domain profiles are currently static in code and not yet sourced from dynamic enterprise configuration management.
- Compliance export is snapshot-based and does not yet include signed external notarization workflow.

## Next Segment Handoff
- Recommended next segment: `S47` (Compliance controls)
- Required context for next segment:
  - Federation execution now emits residency/connectivity attestable metadata that can feed SOC2/ISO evidence automation.

## Mandatory Confirmation
- [x] `docs/agenthub-master-plan-v1.2.docx` updated
- [x] `docs/DELIVERABLE_LOG.md` updated
